#!/bin/bash
  
#SBATCH --time=10
#SBATCH --ntasks=7
#SBATCH --nodes=7
#SBATCH --ntasks-per-node=1
#SBATCH --partition=west
#SBATCH --output=job.out
#SBATCH --error=job.err

export ENSEMBLES_IDLE_ONLY=False
export ENSEMBLES_IDLE_ONLY_TIME=12

export ENSEMBLES_MPIEXEC_PATH=mpiexec
export ENSEMBLES_MPIEXEC_NODES=1

export ENSEMBLES_NUMIO_PATH=numio-posix

export ENSEMBLES_LOG_EVERY_X_SECONDS=3
export ENSEMBLES_GRAPH_OUT_PATH=plots
export ENSEMBLES_GRAPH_FILETYPE=pdf
export ENSEMBLES_DATA_OUT_PATH=data

export ENSEMBLES_LINES=500
export ENSEMBLES_ITERATIONS=9000
export ENSEMBLES_PERT=True

export ENSEMBLES_NUMIO_RW_PATH=matrix.out
export ENSEMBLES_NUMIO_RW_FREQUENCY=64
export ENSEMBLES_NUMIO_READ=True
export ENSEMBLES_NUMIO_WRITE=True
export ENSEMBLES_NUMIO_R_IMMEDIATE=True
export ENSEMBLES_NUMIO_W_NOFILESYNC=False
export ENSEMBLES_NUMIO_W_IMMEDIATE=True

export ENSEMBLES_NUMIO_COLLECTIVE_COMMS=True
export ENSEMBLES_NUMIO_COLLECTIVE_COM_SIZE=200
export ENSEMBLES_NUMIO_COLLECTIVE_COM_FREQ=64
export ENSEMBLES_NUMIO_FPISIN=True
export ENSEMBLES_NUMIO_FILE_PER_PROCESS=True
export ENSEMBLES_NUMIO_ASYNC_WRITE=False
export ENSEMBLES_NUMIO_GZIP=True
export ENSEMBLES_NUMIO_LZ4=False
export ENSEMBLES_NUIMIO_CHUNK_MULTIPLIER=1
export ENSEMBLES_NUMIO_COMPRESS_LEVEL=1

export ENSEMBLES_NUMIO_THREAD=1

export ENSEMBLES_BACKGROUND_PROCESS_LIST='["cpu","idle","ram","find","read","write"]' 

export ENSEMBLES_IPERF_PATH=iperf3
export ENSEMBLES_IPERF_SERVER_IP=136.172.61.247
export ENSEMBLES_IPERF_PORT=5201

export ENSEMBLES_WRITE_PATH=$HOME/ensembles_write

export ENSEMBLES_READ_PATH=$HOME/ensembles_read

export ENSEMBLES_FIND_PATH=find
export ENSEMBLES_FIND_SEARCH_PATH=$HOME

mpiexec python src/main.py
